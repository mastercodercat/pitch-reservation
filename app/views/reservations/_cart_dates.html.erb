<div id="cart_dates">
  <%= form_tag update_cart_path, :remote => true do %>
    <%= label_tag :reserver_id, 'Reserver' %><br />
    <% if current_user && (current_user.is_admin_in_adminmode? || current_user.is_admin_in_checkoutpersonmode? || current_user.is_checkout_person?) %>
      <%= autocomplete_field_tag 'fake_reserver_id', User.find(cart.reserver_id).render_name, autocomplete_user_last_name_reservations_path, :size => 30, :update_elements => {:id => '#reserver_id'}, :class => 'submittable' %>
      <%# we're watching ('submittable') the hidden field because watching the autocomplete catches fakereserver which will cause it to fail in application_controller#update_cart %>
      <%= hidden_field_tag 'reserver_id', cart.reserver_id %>
    <% elsif ! current_user %>
        Please sign in <br />
    <% else %>
      <%= text_field_tag 'fake_reserver_id', current_user.name, :value => current_user.name, :disabled => true %>
      <%= hidden_field_tag 'reserver_id', fake_reserver_id  %>
    <% end %>
    <p>
      <%= label_tag :start_date, 'Start of reservation' %><br />
      <%= datepicker_input "cart", "start_date_cart", :class => 'submittable', :class => 'submitchange', :value => cart.start_date.strftime('%m/%d/%Y') %>
    </p>
    <p>
      <%= label_tag :due_date, 'End of reservation' %><br />
      <%= datepicker_input "cart", "due_date_cart", :class => 'submitchange', :value => cart.due_date.strftime('%m/%d/%Y'), :minDate => cart.start_date.strftime('%m/%d/%Y') %>
  <% end %>
</div>
