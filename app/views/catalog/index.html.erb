<% title "Catalog" %>

<div id = 'models_available'>
<% if @equipment_models_by_category.empty? %>
  <%= render partial: no_equipment %>
  <% else %>
    <% if @pagination_required %>
      <div class="row">
        <div id="pagination_line" class="span9">
          <%# for kaminari pagination %>
          <%= paginate @paginated_eq_models_by_category,
                params: {controller: 'catalog', action: 'index' } %>
          <%= form_tag update_user_per_cat_page_path,
                id: 'items_per_form', class: "form-inline pull-right",
                remote: true, method: 'put' do %>
            <%= label_tag "Items per page:" %>
            <%= select_tag :user_cat_items_per_page,
                  options_for_select(@user_per_page_opts, session[:user_per_cat_page]),
                  :class => 'span1 autosubmitme' %>
          <% end %>
        </div>
      </div>
    <% end %>

    <% @equipment_models_by_category.each do |category, equipment_models| %>
      <h2 class="catalog">
        <%= link_to category.name, category_equipment_models_path(category) %>
      </h2>
      <% unless equipment_models.nil? %>
        <ul class="thumbnails">
        <% equipment_models.each do |equipment_model| %>
          <li class="span3">
            <%= render partial: 'equipment_model_div', locals: { equipment_model: equipment_model, relevant_reservations: @relevant_reservations } %>
          </li>
        <% end %>
        </ul>
      <% end %>
    <% end %>
    <% if @pagination_required  %>
      <%= paginate @paginated_equipment_models_by_category %>
    <% end %>
<% end %>
</div>
