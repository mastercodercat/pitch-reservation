<% title @equipment_model.name %>
<% subtitle @equipment_model.category.name.singularize %>

<div class="row em_info">
  <div class="span3">
  <% if @equipment_model.photo.exists? %>
  <div class="image_box">
    <%= image_tag @equipment_model.photo.url(:large) %>
  </div>
    
  <% else %>
      <%= image_tag "no-image-260.gif" %>
  <% end %>
  </div>
  <div class="span6">
    <div class="row">  
      <div class="span4">
        <h3 class="availability">
          <%= @equipment_model.available?(cart.start_date..cart.due_date) || "0"%> available of <%= @equipment_model.equipment_objects.size %>
        </h3>
        <p>    
          <%= content_tag :div, class: "progress progress-striped #{progress_color}" do %>
            <%= content_tag :div, nil, class: 'bar', style: "width: #{bar_progress};" %>
          <% end %>
        </p>
        <h3 class="availability">from <%= cart.start_date.strftime("%b %d, %Y") %> â€“ <%= cart.due_date.strftime("%b %d, %Y") %></h3>
      </div>


      <div class="span2">
          <%= link_to "Add to Cart", {:url => add_to_cart_path(@equipment_model)}, 
        															:href => add_to_cart_path(@equipment_model), 
        															:remote => true, :class => 'btn btn-primary btn-large' %>
      </div>
    </div>
  
    <div class="associated_em_box">    
      <div class="row">
          <div class="span6">
            <h3>Users Tend to Also Reserve:</h3>
            <% unless @equipment_model.associated_equipment_models.empty? %>
              <fieldset>
                <legend>Recommended Items:</legend>
                <ul>
                  <% @equipment_model.associated_equipment_models.each do |accessory| %>
                    <li><%= accessory.name %> <%= link_to "[add to cart]", {:url => add_to_cart_path(accessory)}, :href => add_to_cart_path(accessory), :remote => true %></li>
                  <% end %>
                </ul>
              </fieldset>
            <% end %>
          </div>
        </div>
        <div class="row">
          <% 6.times do %>
            <div class="span1">
              <%= image_tag "no-image-260.gif" %>
            </div>
          <% end %>
        </div>
    </div>
    
  </div>
  
</div>

<hr />
<!-- SUBNAV SECTION -->
<div class="subnav">
  <ul class="nav nav-pills">
    <li><a href="#description">Description</a></li>
    <li><a>Details</a></li>
    <li><a>Documentation</a></li>
    <li><a>Items</a></li>
    <li><a>Procedures</a></li>
  </ul>
</div>

<!-- SUBBODY SECTION -->

  <h3><legend id="description">Description</legend></h3>
  <p>
    <%= @equipment_model.formatted_description.html_safe %>
  </p>


  <h3><legend id="details">Details</legend></h3>
  <%= content_tag :div, :class => 'row' do %>
    <%= content_tag :div, :class => 'span4' do %>
      <h4>Late Fee</h4>
    <% end %>
    <%= content_tag :div, :class => 'span3' do %>
      <h4>Replacement Fee</h4>
    <% end %>
    <%= content_tag :div, :class => 'span2' do %>
      <% if current_user.is_admin_in_adminmode? %>
        <h4>Max. Per User</h4>
      <% end %>
    <% end %>
  <% end %>
  
  <%= content_tag :div, :class => 'row giant-numbers' do %>
    <%= content_tag :div, :class => 'span4' do %>
      <%= number_to_currency(@equipment_model.late_fee) %> / day
    <% end %>
    <%= content_tag :div, :class => 'span3' do %>
      <%= number_to_currency(@equipment_model.replacement_fee) %>
    <% end %>
    <%= content_tag :div, :class => 'span2' do %>      
      <%= @equipment_model.maximum_per_user if current_user.is_admin_in_adminmode? %>
    <% end %>
  <% end %>
  
  <h3><legend id="documentation">Documentation</legend></h3>
  <%= content_tag :div, :class => 'row' do %>
    <%= content_tag :div, :class => 'span3' do %>
      <h4>
        <%= (link_to @equipment_model.documentation_file_name, @equipment_model.documentation.url) unless !@equipment_model.documentation.exists? %>
      </h4>
    <% end %>
  <% end %>
  <%= content_tag :div, :class => 'row' do %>
    <%= content_tag :div, :class => 'span2' do %>
      <%= link_to @equipment_model.documentation.url do %>
        <%= content_tag :i, nil, :class => 'icon-file document' %>
      <% end %>
    <% end %>
  <% end %>
  
  
  <% if current_user.is_admin_in_adminmode? %>
    <h3><legend id="items">Items</legend></h3>
    
    <p>
      <%= link_to "Create New "+@equipment_model.name.singularize+" Item", new_equipment_model_equipment_object_path(@equipment_model), :class => 'btn' %>
    </p>
    <p id="equipment_objects">
      <% if @equipment_model.equipment_objects.empty? %>
        (none)
      <% else %>
            <%= render 'equipment_objects_table' %>
      <% end %>
    </p>
    
    <h3><legend>Procedures</legend></h3>
    <%= content_tag :div, :class => 'row' do %>
      <%= content_tag :div, :class => 'span4' do %>
        <p><h4>Check-Out</h4></p>
      <% end %>
      <%= content_tag :div, :class => 'span4' do %>
        <p><h4>Check-In</h4></p>
      <% end %>
    <% end %>
    
    <%= content_tag :div, :class => 'row' do %>
      <%= content_tag :div, :class => 'span4' do %>
        <% if @equipment_model.checkout_procedures.empty? %>
          <p>(none)</p>
        <% else %>
          <ol>
            <% @equipment_model.checkout_procedures.each do |checkout_procedure| %>
              <li><%= checkout_procedure.step %></li>
            <% end %>
          </ol>
        <% end %>
      <% end %>
      <%= content_tag :div, :class => 'span4' do %>
        <% if @equipment_model.checkin_procedures.empty? %>
          (none)
        <% else %>
          <ol>
            <% @equipment_model.checkin_procedures.each do |checkin_procedure| %>
              <li><%= checkin_procedure.step %></li>
            <% end %>
          </ol>
        <% end %>
      <% end %>
    <% end %>  
    
  <% end %>

</fieldset>


<div class="form-actions">
  <% if current_user.is_admin_in_adminmode? %>
    <%= link_to "Edit "+@equipment_model.name, edit_equipment_model_path(@equipment_model), :class => 'btn' %>
    <%= link_to "Destroy "+@equipment_model.name, @equipment_model, :confirm => 'This will permanently delete the Object from your database and could have unintended consequences. You might break all the things. Are you sure?', :method => :delete, :class => 'btn btn-danger' %>
  <% end %>
  <%= link_to "View All "+@equipment_model.category.name.pluralize, category_equipment_models_path(@equipment_model.category), :class => 'btn view_all' %>
</div>
